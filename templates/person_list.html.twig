{% extends 'base.html.twig' %}

{% block title %}{{ 'person.list'|trans }}{% endblock %}

{% block body %}
    <h1>{{ 'person.list'|trans }}</h1>

    <div style="margin-bottom: 16px; display: flex; gap: 10px;">
        <a href="{{ path('person_form') }}">
            <button type="button">{{ 'person.new_record'|trans }}</button>
        </a>
        <a href="{{ path('app_login') }}">
            <button type="button">{{ 'menu.login'|trans }}</button>
        </a>
    </div>

    <form method="get" action="{{ path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')) }}" style="margin-bottom: 16px;">
        <input type="text" name="search" value="{{ search }}" placeholder="{{ 'search.placeholder'|trans }}">
        <button type="submit">{{ 'search.button'|trans }}</button>
    </form>
    
    <ul>
        {% for person in people %}
            <li>
                {{ person.name }} | {{ person.birthDate|date('Y-m-d') }} | {{ person.work }} | 
                {{ 'person.accepts_commercial'|trans }}: {{ person.acceptsCommercial ? 'general.yes'|trans : 'general.no'|trans }}
                <a href="{{ path('person_edit', {id: person.id}) }}">
                    <button type="button">{{ 'person.edit'|trans }}</button>
                </a>
                <form action="{{ path('person_delete', {id: person.id}) }}" method="post" style="display:inline;">
                    <button type="submit" onclick="return confirm('{{ 'person.delete_confirm'|trans }}');">{{ 'person.delete'|trans }}</button>
                </form>
            </li>
        {% else %}
            <li>{{ 'person.no_records'|trans }}</li>
        {% endfor %}
    </ul>

    {% if pages > 1 %}
        <div style="margin-top:16px;">
            {% for p in 1..pages %}
                {% if p == page %}
                    <span>[{{ p }}]</span>
                {% else %}
                    <a href="{{ path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')|merge({'page': p, 'search': search})) }}">{{ p }}</a>
                {% endif %}
            {% endfor %}
        </div>
    {% endif %}

    {% if locale is defined %}
        <div style="margin-top: 20px;">
            <strong>{{ 'language.change'|trans }}:</strong>
            <a href="{{ path('person_list_locale', {'_locale': 'en'}) }}">English</a> | 
            <a href="{{ path('person_list_locale', {'_locale': 'es'}) }}">Espa√±ol</a>
        </div>
    {% endif %}
{% endblock %}